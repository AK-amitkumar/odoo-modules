<?xml version="1.0" encoding="utf-8" ?>
<!--
##############################################################################
#
#    Copyright (c) 2015 be-cloud.be
#                       Jerome Sonnet <jerome.sonnet@be-cloud.be>
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the GNU Affero General Public License as
#    published by the Free Software Foundation, either version 3 of the
#    License, or (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU Affero General Public License for more details.
#
#    You should have received a copy of the GNU Affero General Public License
#    along with this program.  If not, see <http://www.gnu.org/licenses/>.
#
##############################################################################
-->
<odoo>
    <template id="report_policy_sheet">
        <t t-call="report.html_container">
            <t t-set="data_report_margin_top" t-value="45" />
            <t t-set="data_report_header_spacing" t-value="40" />
            <t t-set="o" t-value="docs[0]" />
            <t t-call="report.external_layout">
                <div class="page">
                    <!-- Intro -->
                    <div id="introduction" class="page-header mt16">
                        <h2>Your Policy Information - <em t-esc="o.policy_id.name"/></h2>
                        <br/>
                        <h4>Policy Group : XXXXXXX - Situation on <span t-field="docs[0].reporting_date"/></h4>
                    </div>
                    <!-- Informations -->
                    <div class="row mt32">
                        <div class="col-md-4 col-xs-4">
                            <div class="row">
                                <label class="col-sm-12 col-xs-12">Policy Holder:</label>
                                <div class="col-sm-8 col-xs-8 col-sm-offset-4 col-xs-offset-4">
                                    <address t-field="o.policy_id.policy_holder_id" t-field-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": true}' />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8 col-xs-8">
                            <div class="row">
                                <label class="col-sm-12 col-xs-12">Insured Person:</label>
                                <div class="col-sm-4 col-xs-4">
                                    <div t-field="o.policy_id.insured_person_id.image" t-field-options='{"widget": "image", "class": "media-object center-block", "max_width": 128}' />
                                </div>
                                    <div class="col-md-8 col-xs-8">
                                    <table class="table table-condensed">
                                        <colgroup>
                                            <col style="width:40%"/>
                                            <col style="width:60%"/>
                                        </colgroup>
                                        <tbody>
                                            <tr>
                                                <td>Name</td>
                                                <td><span t-field="o.insured_person_id.name" /></td>
                                            </tr>
                                            <tr>
                                                <td>Sex</td>
                                                <td><span t-field="o.insured_person_id.sex" /></td>
                                            </tr>
                                            <tr>
                                                <td>Birthdate</td>
                                                <td><span t-field="o.insured_person_id.birthdate" /></td>
                                            </tr>
                                            <tr>
                                                <td>Family Status</td>
                                                <td><span t-field="o.insured_person_id.family_status" /></td>
                                            </tr>
                                            <tr>
                                                <td>Partner birthdate</td>
                                                <td><span t-field="o.insured_person_id.partner_birthdate" /></td>
                                            </tr>
                                            <tr>
                                                <td>Children</td>
                                                <td><span t-field="o.insured_person_id.children" /></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="clearfix" />
                        <div class="col-md-12 col-xs-12">
                            <table class="table table-condensed">
                                <colgroup>
                                    <col style="width:65%"/>
                                    <col style="width:35%"/>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th><strong>Computation Data</strong></th>
                                        <th><strong></strong></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Service from </td>
                                        <td><span t-field="o.insured_person_id.service_from" /></td>
                                    </tr>
                                    <tr>
                                        <td>Career Term</td>
                                        <td><span t-field="o.insured_person_id.retirement_date" /></td>
                                    </tr>
                                    <!--<tr>
                                        <td>Complete career duration</td>
                                        <td><t t-esc="import math;'%.0f'%math.floor(o.insured_person_id.complete_career_duration)"/> années <t t-esc="import math;'%.0f'%math.floor((o.insured_person_id.complete_career_duration-math.floor(o.insured_person_id.complete_career_duration))*12)"/> mois</td>
                                    </tr>
                                    <tr>
                                        <td>Accomplished career duration on <span t-field="docs[0].reporting_date" /></td>
                                        <td><t t-esc="import math;'%.0f'%math.floor(o.accomplished_career_duration)"/> années <t t-esc="import math;'%.0f'%math.floor((o.accomplished_career_duration-math.floor(o.accomplished_career_duration))*12)"/> mois</td>
                                    </tr>-->
                                    <tr>
                                        <td>Complete career duration</td>
                                        <td><span t-field="o.insured_person_id.complete_career_duration"/></td>
                                    </tr>
                                    <tr>
                                        <td>Accomplished career duration on <span t-field="docs[0].reporting_date" /></td>
                                        <td><span t-field="o.accomplished_career_duration"/></td>
                                    </tr>
                                    <tr>
                                        <td>Annual pay (100%)</td>
                                        <td><span t-field="o.insured_person_id.annual_pay" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td>Activity percentage</td>
                                        <td><t t-esc="o.insured_person_id.activity_percentage*100" /> %</td>
                                    </tr>
                                    <tr>
                                        <td>Index</td>
                                        <td><span t-field="o.insured_person_id.salary_index" /></td>
                                    </tr>
                                    <tr>
                                        <td>Final annual pay (100%)</td>
                                        <td><span t-field="o.insured_person_id.final_annual_pay" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td>Legal pension ceiling</td>
                                        <td>53.000,00 €</td><!-- TODO make this a paramter somehow -->
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="clearfix" />
                        <div class="col-md-12 col-xs-12">
                            <table class="table table-condensed">
                                <colgroup>
                                    <col style="width:65%"/>
                                    <col style="width:35%"/>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th><strong>Payments in case of life at retirement based</strong></th>
                                        <th><strong/></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Term</td>
                                        <td><span t-field="o.insured_person_id.retirement_date" /></td>
                                    </tr>
                                    <tr>
                                        <td>Projected capital </td>
                                        <td><span t-field="o.policy_id.projected_life_capital" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td>Projected equivalent annuity </td>
                                        <td><span t-field="o.policy_id.projected_life_annuity" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td>Current earned capital </td>
                                        <td><span t-field="o.life_earned_capital" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td>Current earned reserve </td>
                                        <td><span t-field="o.life_earned_reserve" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="col-md-8 col-xs-8">
                                                <table class="table table-condensed">
                                                    <colgroup>
                                                        <col style="width:65%"/>
                                                        <col style="width:35%"/>
                                                    </colgroup>
                                                    <thead>
                                                        <tr>
                                                            <th><strong>Policy</strong></th>
                                                            <th><strong>Employer</strong></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>Policy Number</td>
                                                            <td><span t-field="o.policy_id.life_number" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Policy Type</td>
                                                            <td><span t-field="o.policy_id.life_type" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Value on <span t-field="docs[0].reporting_date"/>:</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td> - Mathematical reserve</td>
                                                            <td><span t-field="o.policy_mr" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td> - Mathematical reserve bonus</td>
                                                            <td><span t-field="o.policy_mr_bonus" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Value on <span t-field="o.insured_person_id.retirement_date" />:</td>
                                                            <td></td>
                                                        </tr>
                                                        <tr>
                                                            <td> - Capital</td>
                                                            <td><span t-field="o.policy_capital" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td> - Capital bonus</td>
                                                            <td><span t-field="o.policy_capital_bonus" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Unique premium</td>
                                                            <td><span t-field="o.policy_unique_premium" /></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="clearfix" />
                        <div class="col-md-12 col-xs-12">
                            <table class="table table-condensed">
                                <colgroup>
                                    <col style="width:65%"/>
                                    <col style="width:35%"/>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th><strong>Payments in case of death before retirement</strong></th>
                                        <th><strong/></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Annuity per orphan </td>
                                        <td><span t-field="o.policy_id.orphan_annuity_per_child" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div class="col-md-8 col-xs-8">
                                                <table class="table table-condensed">
                                                    <colgroup>
                                                        <col style="width:65%"/>
                                                        <col style="width:35%"/>
                                                    </colgroup>
                                                    <thead>
                                                        <tr>
                                                            <th><strong>Policy</strong></th>
                                                            <th><strong>Employer</strong></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>Policy Number</td>
                                                            <td><span t-field="o.policy_id.death_number" /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Policy Type</td>
                                                            <td><span t-field="o.policy_id.death_type" /></td>
                                                        </tr>
                                                        
                                                        <tr>
                                                            <td>Death Capital </td>
                                                            <td><span t-field="o.policy_id.death_capital" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Orphan Annuity Capital</td>
                                                            <td><span t-field="o.policy_id.orphan_annuity_capital" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Death Unique Premium </td>
                                                            <td><span t-field="o.policy_id.death_unique_premium" t-field-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>
